---
title: "네트워크(3)-IP 어드레싱"
excerpt: "컴퓨터공학을 정리해봅니다."

categories:
  - cs
tags:
  - computer science
  - network
last_modified_at: 2020-02-06T08:06:00-05:00
---

> 책 `<하루 3분 네트워크 교실 >, 아미노 에이지` 을 읽고 정리한 내용입니다
>
> [1. 네트워크 기초 지식](/cs/network_1)에서는 네트워크 구축과 순서, 단계와 물리 계층을 다루고 있습니다
>
> [2. 신호의 전송과 충돌](/cs/network_2)에서는 데이터링크 계층에 대해 다루고 있습니다.

이번 포스팅과 다음 포스팅에서는 3계층인 네트워크 계층에 대해 다룹니다. 이 포스팅에서는 IP 어드레싱에 대해 주로 다뤄봅니다.

# 네트워크 계층의 역할과 개요

데이터링크 계층은 세그먼트 내(라우터와 라우터 간의 범위)에서의 송수신 역할을 한다. **세그먼트 간 데이터 송수신 역할을 하는 것이 네트워크 계층의 역할**이다.

네트워크란 **라우터와 라우터로 분배된 컴퓨터 그룹(=세그먼트)**이다.

## 인터넷 작업

네트워크를 라우터로 나눔으로써, **라우터를 넘어서는 브로드캐스트는 송신하지 않게끔** 한다.

- 스위치로 구성된 네트워크에서는 1대가 송신한 브로드캐스트가 모든 컴퓨터에 도달한다.

네트워크 간 데이터 통신을 **인터넷 작업**이라 한다.



# IP

**어드레싱**

- 네트워크 계층의 주소는 **논리 주소**라고 불리며 위치정보를 가지고 있다.
  - 데이터링크 계층의 MAC 주소는 **물리 주소**

**라우팅**

- 경로 선택. **수신처까지 어떤 경로로 갈 지를 결정한다.**

------------

TCP / IP 에서는 IP를 반드시 사용한다.

IPv4와 IPv6라는 IP의 두 버전은 호환성이 없다.

IP헤더가 붙은 PDU를 **패킷**이라고 한다. 

![IP 헤더 이미지 검색결과](https://lh3.googleusercontent.com/proxy/LQGkW49CAm0OsxSBH-ixVocKNuyN9QJbTNn9pP0tgKNA08a-v27w-5Ze-2gexzvKNi8nnAz4LPTi-jYQE2hn9tfj7OTe4SRBMzxHER-ZiVypXI2Zv7bdioNMCnlZ_QFjPiygKHLvbMof9iKn3bQeGNh67hzvSeGDvWPxl-DAgB2CFfh9RQ)

# IP 주소

IP주소는 계층형 주소의 특징을 갖는다.

IP주소는 네트워크 관리자가 컴퓨터에 할당한다.

IP주소는 네트워크에 접속할 때마다 할당한다.

- 네트워크가 바뀐 경우 논리 주소도 바뀌게 된다
- MAC주소의 경우 네트워크가 바뀌어도 바뀌지 않는다.

논리 주소에도 유니캐스트, 멀티캐스트, 브로드캐스트가 있다.

유니캐스트의 논리 주소 중 **네트워크를 표시하는 번호는 접속되어 있는 모든 네트워크에서 유일**해야 한다.

- 네트워크 IP는 접속되어 있는 모든 네트워크에서 유일하다
- 호스트 IP는 네트워크 내에서 유일하다.

IPv4의 주소는 32비트이고, IPv6의 128비트

- IPv4는 8비트마다 10진수로 표기하고, 8비트(옥텟) 사이에 점을 찍는 표현
  - `192. 168. 0. 1.`
- 4개의 옥텟, 32비트로 네트워크 IP와 컴퓨터 IP를 나타낸다.

## 클래스

IP주소를 조직의 규모에 따라 A~E로 나누고 그 범위의 주소를 할당한다.

클래스에 의해 호스트 IP의 비트수가 정해지고, 이것으로 조직이 가질 수 있는 IP주소의 수량이 결정된다.

이를 **클래스풀 어드레싱**이라 한다.

![ip class 이미지 검색결과](https://lh3.googleusercontent.com/proxy/DXFqA4tulfCjk3-TT9vgpALXbkcQhtSWKqCz7m7S-PFka6TMC-Gllq_cgqcBNCuUSmH_mAJ0AswoCzqV0vVK5tS60RfrUi9EUXeCLEBIkwy_y3PUwxqrQeWkZyYwsYrq8c6kimJPrKV4UGUoVi7w93ByGI0Zys1D-1IIQh4)

ICANN에서는 네트워크 IP까지만 지정하고, 해당 네트워크의 관리자가 호스트 IP를 정한다.

## 예약 완료 주소

호스트 번호의 주소가 모두 0인 주소를 네트워크 주소, 모두 1인 주소를 브로드캐스트 주소라고 한다.

- 네트워크 주소는 네트워크 자체를 나타내고
- 브로트캐스트 주소는 네트워크 내 모든 컴퓨터를 표시하는 주소

이 두 주소는 실제 컴퓨터에 할당해서는 안된다.

![network address and broadcast address 이미지 검색결과](https://learn-networking.com/wp-content/uploads/2008/02/class-broadcast-address.jpg)

# 서브네팅

## 네트워크 분할

IP주소는 계층형이다. 커다란 네트워크를 몇 개의 네트워크로 작게 분할한다.

이렇게 분할된 작은 네트워크를 **서브네트워크**라 한다.

호스트 번호의 비트를 서브넷 번호와 호스트 번호로 분할한다.

- `172. 16. 4. 1/38` = `172. 16. 0. 0` 네트워크의 서브넷 1번의 1번 컴퓨터

## 서브넷 마스크

서브넷은 해당 네트워크의 내부에서만 유효하다

서브넷의 숫자를 크게 하면 각 서브넷의 호스트 수는 감소한다.

**서브넷 마스크**라는 비트열을 IP주소와 동시에 표기해야 IP 주소에서 1인 비트열을 네트워크 IP, 0인 비트열을 호스트 IP임을 알 수 있다.

# 클래스리스 어드레싱

클래스풀 어드레싱은 사용하지 않는 IP주소가 많아진다는 문제점이 있다.

이러한 문제점을 해결하기 위해 클래스라는 구분이 없앤 어드레싱이 클래스리스 어드레싱

클래스를 통합해서 1개의 네트워크로 운용하는 것을 **슈퍼넷**이라 한다.

**프리픽스 길이**는 **네트워크 번호의 길이를 나타내는 값**으로 IP주소와 같이 표기해준다.



# DHCP

IP 패킷을 송수신하기 위해서는 '수신처 MAC주소', '송신처 MAC주소', '수신처 IP주소', '송신처 IP주소'가 필요하다.

송신처 MAC주소

- **송신할 인터페이스의 MAC 주소를 사용한다.**

송신처 IP 주소

- 수동으로 IP주소 할당
- 동적으로 IP주소 할당
  - **DHCP** Dynamic Host Configuration Protocol

DHCP

- 할당할 IP주소를 관리하고, 실제 할당 작업을 수행하는 DHCP서버와 IP주소를 할당받는 DHCP클라이언트로 이루어진다.

IP주소 풀

- 관리자가 할당할 주소의 범위
- DHCP서버는 IP주소 풀 중 요청한 클라이언트에게 각각 유일한 것이 되도록 주소를 할당한다.

DHCP 서버는 IP주소의 대여 기간을 설정해서 할당한다.

DHCP 메세지는 주소와 옵션 설정 등의 정보를 갖는다.

DHCP는 `DISCOVER` , `OFFER`, `REQUEST`, `ACK` 4 종류의 메세지를 클라이언트와 서버간에 브로드캐스트를 사용해서 주고받는다.

- 클라이언트는 누구에게 메시지를 보내야 할지 모르기 때문에 **브로드캐스트** 전송한다.
- DHCP는 IP주소만이 아니라 다른 네트워크의 설정 정보도 보낼 수 있다. (서브넷마스크, 디폴트 게이트웨이, DNS서버, 대여기간 등)

![DHCP 동작 이미지 검색결과](https://www.netmanias.com/ko/?m=attach&no=1987)

# ARP

이제 수신처 MAC주소와 수신처 IP주소에 대해 알아보자.

수신처 MAC주소는 수신처 IP 주소가 결정된 후에 정해진다.

ARP. Address Resolution Protocol

> 이 IP 주소의 호스트님, 당신의 MAC 주소를 알려 주세요.

## ARP 테이블

컴퓨터는 수신 IP 주소를 결정하고, 이후 MAC 주소를 알기 위해서 ARP 테이블을 참조한다.

- **ARP 테이블은 IP주소와 MAC 주소의 대응표** 

ARP 테이블에 수신처 IP와 MAC 주소의 대응이 있으면 수신처 MAC 주소를 알 수 있다. 하지만 대응이 없는 경우 **ARP요청을 브로드캐스트로 네트워크 내의 모든 컴퓨터에 송신한다.**

ARP 요청을 받은 컴퓨터 중 지정된 IP 주소를 갖는 컴퓨터는 **ARP 응답**을 보낸다.

ARP 응답을 받은 컴퓨터는 **결과를 ARP테이블에 기재**하고

**일정 기간이 지나면 파기**한다.

- 인터페이스 고장 등으로 MAC 주소가 변경되어도 대응할 수 있도록 하기 위해

<img src="https://image.slidesharecdn.com/arpaddressresolutionprotocol-110519232546-phpapp01/95/arp-address-resolution-protocol-5-728.jpg?cb=1305847611" alt="ARP 이미지 검색결과" style="zoom:80%;" />

# DNS

**수신처 IP주소를 알아내는 방법**

사용자가 수신처의 IP주소를 알고 있으면 수동으로 접속 가능

DNS는 도메인 네임과 IP주소를 대응시킨 시스템. 이름과 IP주소의 대응 대이터베이스를 갖고 있는 DNS 서버에 문의해서 수신처의 IP 주소를 입수한다.

다른 조직의 호스트 명과 도메인 네임은 그 조직의 DNS 서버에 문의한다. 일종의 **분산형 데이터베이스**

<img src="https://www.cloudflare.com/img/learning/dns/what-is-dns/dns-lookup-diagram.png" alt="DNS 이미지 검색결과" style="zoom:48%;" />

## 4개의 주소

1. 송신처 MAC 주소

   NIC를 장치하면 자동적으로 알 수 있다.

2. 송신처 IP 주소

   수동 또는 **DHCP**에서 할당받는다.

3. 수신처 IP 주소

   사용자 애플리케이션이 수신처의 도메인 명을 결정하면 **DNS**로 IP주소를 취득한다.

4. 수신처 MAC 주소

   **ARP**에 의해 MAC 주소를 취득한다.

5. 데이터 전송이 가능해진다.

