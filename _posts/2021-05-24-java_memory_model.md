---
title: "자바 메모리 모델(JMM)"
excerpt: "자바 메모리 모델"

categories:
  - TIL
tags:
  - java
  - cs
  - jmm
last_modified_at: 2021-05-24T08:06:00-05:00
---

자바 메모리 모델은 **특정 스레드에서 메모리를 대상으로 취하는 작업이 다른 스레드에게 어떻게 보이는지의 여부**를 명시하고 있다.

메모리 모델 : 프로그램이 메모리 구조에서 어느 정도의 기능을 사용할 수 있을지에 대한 정보를 제공하고, 메모리의 내용을 서로 공유하고자 할 때 프로세스 간의 작업을 조율하기 위한 특별한 명령어(memory barrier)로는 어떤 것들이 있으며 어떻게 사용해야 하는지에 대한 정보를 제공한다.

JMM은 서로 다른 하드웨어가 갖고 있는 각자의 메모리 모델을 직접 신경쓰지 않도록 한다. 

재배치 reordering : 특정 작업이 지연되거나 다른 순서로 실행되는 것처럼 보이는 문제

미리 발생(happens-before) 현상 규칙

- 프로그램 순서 규칙 : 한 스레드에서 프로그램된 순서에서 앞서있는 작업은 동일 스레드에서 뒤에 실행되도록 프로그램된 작업보다 미리 발생한다.
- 모니터 잠금 규칙 : 특정 모니터 잠금 작업이 뒤이어 오는 모든 모니터 잠금 작업보다 미리 발생한다.
- `volatile` 변수 규칙 ; `volatile` 변수에 대한 쓰기 작업은 이후에 따라오는 해당 변수에 대한 모든 읽기 작업보다 미리 발생한다.
- 스레드 시작 규칙 : 특정 스레드에 대한 `Thread.start` 작업은 시작된 스레드가 갖고 있는 모든 작업보다 미리 발생한다
- 스레드 완료 규칙 : 스레드 내부의 모든 작업은 다른 스레드에서 해당 스레드가 완료되었다는 점을 파악하는 시점보다 미리 발생한다.
- 인터럽트 규칙 : 다른 스레드를 대상으로 `interrupt` 메서드를 호출하는 작업은 인터럽트 당한 스레드에서 인터럽트를 당했다는 사실을 파악하는 일보다 미리 발생한다.
- 완료 메서드(`finalizer`) 규칙 : 특정 객체에 대한 생성 메소드가 완료되는 시점은 완료 메서드가 시작하는 시점보다 미리 발생한다.
- 전이성(`transitivity`) : A가 B보다 미리 발생하고, B가 C보다 미리 발생한다면, A는 C보다 미리 발생한다.

