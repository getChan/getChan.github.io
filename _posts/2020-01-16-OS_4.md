---
title: "운영체제(4)-프로세스 관리:man_factory_worker:"
excerpt: "컴퓨터공학을 정리해봅니다."

categories:
  - cs
tags:
  - study
  - computer science
  - os
last_modified_at: 2020-01-16T08:06:00-05:00
---

> 책 `<운영체제와 정보기술의 원리>, 반효경` 을 읽고 정리한 내용입니다
>
> [운영체제(1) - 개요](/cs/OS_1)
>
> [운영체제(2) - 컴퓨터 시스템의 동작 원리](/cs/OS_2)
>
> [운영체제(3) - 인터럽트의 원리](/cs/OS_3)

# 프로세스 개념

프로세스란?

- 수행중인 프로그램
- 프로그램이 메모리에 올라가서 수행되면 프로세스가 된다
- == JOB

![프로세스의 문맥을 구성하는 요소에 대한 이미지 검색결과](https://img1.daumcdn.net/thumb/R720x0.q80/?scode=mtistory2&fname=http%3A%2F%2Fcfile8.uf.tistory.com%2Fimage%2F9927563C5B00FF8D0F9399)

프로세스의 문맥(Context)

- 프로세스의 상태를 담고 있는 정보
- 하드웨어 문맥
  - CPU의 수행 상태를 나타낸다.
  - Program Counter
  - 각종 레지스터에 저장하고 있는 값들
- 프로세스의 주소 공간
  - 코드, 데이터, 스택
- 커널 상의 문맥
  - PCB
  - 커널 스택

# 프로세스의 상태

![프로세스의 문맥을 구성하는 요소에 대한 이미지 검색결과](https://eunhyejung.github.io/assets/contents/content07.PNG)

**실행 Running**

- 프로세스가 CPU를 보유하고 기계어 명령을 실행하고 있는 상태

**준비 Ready**

- 프로세스가 CPU만 보유하면 명령을 실행할 수 있으나, CPU를 할당받지 못한 상태

**봉쇄 Blocked (Waiting)**  

- 프로세스에게 CPU를 주어도 당장 명령을 실행할 수 없는 상태

생성 New

- 프로세스가 생성 중
- 아직 메모리 획득을 승인받지 못한 상태

완료 Terminated

- 프로세스가 종료 중 
- 프로세스 관련 자료구조를 완전히 정리하지 못한 상태

**문맥 교환 Context Switch**

- 실행시킬 프로세스를 변경하기 위해 원래 수행중이던 프로세스의 문맥을 저장하고 새로운 프로세스의 문맥을 세팅하는 과정

CPU 디스패치

- 준비 상태에 있는 프로세스 중 CPU를 할당받을 프로세스를 선택한 후 CPU의 제어권을 넘겨받는 과정

## 상태 변화 예시

1. 프로세스A가 실행 중 I/O 요청
2. 프로세스A를 I/O장치 큐로 보낸다.(blocked)
3. 준비 큐의 프로세스 중 하나인 프로세스B에 CPU를 할당(ready -> running)
4. 프로세스 A의 입출력 작업 완료
5. I/O 컨트롤러는 CPU에게 하드웨어 인터럽트 발생 *"입출력 완료!"*
6. 프로세스 B가 커널 모드로 진입
7. 인터럽트 루틴 수행
   1. 프로세스 A를 I/O 큐에서 빼내 ready queue로 (ready)
   2. I/O장치의 local buffer 내용을 memory로 이동
8. 프로세스 B에게 다시 CPU 할당 *(경우에 따라 준비 큐에 있는 다른 프로세스에게 할당할 수도 있다.)*
9. 프로세스 B를 다시 user mode로

# 프로세스 제어 블록 PCB

**운영 체제가 시스템 내의 프로세스들을 관리하기 위해 프로세스당 유지하는 정보들을 담는 커널 내의 자료구조**

![img](https://t1.daumcdn.net/cfile/tistory/99F6404A5B00FF8D16)

- 프로세스의 상태
  - CPU할당 가능 여부를 결정하기 위해
- 프로그램 카운터 값
  - 다음에 수행할 명령의 위치
- CPU 레지스터
  - CPU연산을 위해 현재 레지스터에 어떤 값을 저장하고 있는지
- CPU 스케줄링 정보
  - 프로세스의 CPU 스케줄링을 위해
- 메모리 관리 정보
  - 플로세스의 메모리 할당을 위해
- 자원 사용 정보
  - 자원 사용 요금 청구 등
- 입출력 상태 정보

# 문맥 교환

**하나의 프로세스로부터 다른 사용자 프로세스로 CPU의 제어권이 이양되는 과정**

1. 프로세스 A가 CPU를 할당받고 실행되던 중 타이머 인터럽트 발생

2. CPU 제어권 OS가 가지고 타이머 인터럽트 처리 루틴 실행

   1. 프로세스 A의 문맥을 A의 PCB에 저장하고(Ready)

   2. 새로운 프로세스 B에게 CPU를 이양(Running)

      이전에 실행했던 B의 문맥을 복원

타이머 인터럽트 뿐만 아니라 실행중이던 프로세스가 Blocked상태가 되면 발생

![img](https://t1.daumcdn.net/cfile/tistory/998D6B3B5B00FF8D09)

프로세스가 실행 상태일 때 시스템 콜이나 인터럽트가 발생하면 CPU의 제어권이 OS에게 넘어와 원래 프로세스를 잠시 멈추고 OS kernel의 코드가 실행된다. 이 경우에도 CPU의 실행 위치 등 프로세스 문맥 중 일부를 PCB에 저장하지만, 문맥 교환은 아니다. CPU 점유하는 프로세스가 다른 user process로 바뀌지 않기 때문. (ex. I/O 완료 인터럽트)

이는 모드 변경만 일어나는 것이고, 문맥 교환은 오버헤드가 훨씬 크다.

